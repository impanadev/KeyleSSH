@startuml Sign-in
!include https://raw.githubusercontent.com/bschwarz/puml-themes/master/themes/aws-orange-light/puml-theme-aws-orange-light.puml


title Sign-in
note over Client
Web SSH Client
end note
activate Client
activate Server
Client->Server: client key exchange init
Server->Client: server key exchange init
Client->Client: match encryption and hashing with server
Client<->Server: Diffie-Hellman Key exchange

Client->TideButton: Press Buttton
activate TideButton

note over TideButton, Enclave
Enclave requested from Home ORK
end note
TideButton->Enclave: request enclave 
deactivate TideButton

activate Enclave
Enclave->Enclave: sign-in
Enclave->Enclave: validate


alt sign && valid ?
    Enclave->Client:cvk.pub, signature
    else
    Enclave->Client:401()
    deactivate Enclave
end

Client->Server: ssh-userauth (cvk.pub, signature)
Server->Server: Compare received keys for authority
Server->Client: userauth success
deactivate Server


deactivate Client
@enduml